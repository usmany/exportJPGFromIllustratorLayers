// abrimos el archivo que vamos a procesarvar archivo = File.openDialog('Selecciona el EPS a procesar', function (f) { return (f instanceof Folder) || f.name.match(/\.eps$/i);} );app.open (archivo);docActivo = app.activeDocument;// seleccionamos la carpeta donde lo vamos a guardarvar folderDestino = Folder.selectDialog ("Selecciona una carpeta de destino");var folderDestino = folderDestino.fullName.toString();var totalLayers = docActivo.layers.length;var baseLayer = docActivo.layers[totalLayers -1];baseLayer.visible = true;function exportFileToJPEG (dest) {	var exportOptions = new ExportOptionsJPEG();	var type = ExportType.JPEG;	var fileSpec = new File(dest);	exportOptions.antiAliasing = true;	exportOptions.qualitySetting = 100;	docActivo.exportFile(fileSpec, type, exportOptions);}// todos los layers a exportar invisiblesfunction hideLayers(totalLayers) {	var menosBase = totalLayers - 1;	for (var i = 0; i < menosBase; i = i + 1) {		docActivo.layers[i].visible = false;	}}function exportThisLayerPlusBase (dest, totalLayers) {	var menosBase = totalLayers - 1;	for (var j = 0; j < menosBase; j = j + 1) {		docActivo.layers[j].visible = true;		exportFileToJPEG(dest + '/' + docActivo.layers[j].name);		docActivo.layers[j].visible = false;	}}hideLayers(totalLayers);exportThisLayerPlusBase (folderDestino, totalLayers);docActivo.close(SaveOptions.DONOTSAVECHANGES);docActivo = null;